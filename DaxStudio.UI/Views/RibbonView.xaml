<UserControl x:Class="DaxStudio.UI.Views.RibbonView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:Fluent="clr-namespace:Fluent;assembly=Fluent"
             xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
             xmlns:cal="clr-namespace:Caliburn.Micro;assembly=Caliburn.Micro"
             xmlns:local="clr-namespace:DaxStudio.UI.Utils" xmlns:conv="clr-namespace:DaxStudio.UI.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="137" d:DesignWidth="571">
   <UserControl.Resources>
        <conv:ResourceLookupConverter x:Key="OutputIcons">
            <ResourceDictionary>
                <BitmapImage x:Key="Grid" UriSource="pack://application:,,,/DaxStudio.UI;component/images/Table.png"/>
                <BitmapImage x:Key="Timer" UriSource="pack://application:,,,/DaxStudio.UI;component/images/metro/timer.png"/>
            </ResourceDictionary>
            </conv:ResourceLookupConverter>
            <BitmapImage x:Key="PlayIcon"  UriSource="..\images\metro\run.png"></BitmapImage>
            <BitmapImage x:Key="TimerIcon"  UriSource="..\images\metro\timer.png"></BitmapImage>
        
       <DataTemplate x:Key="ResultsTargetTemplate">
            <Border Tag="Excel"
                        BorderThickness="4"
                        BorderBrush="Transparent">
                <StackPanel>
                    <Image VerticalAlignment="Top"
                        Source="{Binding Name, Converter={StaticResource OutputIcons}}"
                        Stretch="None" />
                    <TextBlock Text="{Binding Name}"
                        VerticalAlignment="Bottom"
                        HorizontalAlignment="Center" />
                </StackPanel>
            </Border>
       </DataTemplate>
        
    </UserControl.Resources>
    <Fluent:Ribbon Height="Auto">
        <Fluent:Ribbon.Resources>

            <DataTemplate x:Key="TraceWatcherTemplate">
                <Fluent:ToggleButton Header="{Binding Title}" IsChecked="{Binding IsChecked, Mode=TwoWay}"  Size="Middle" ClickMode="Press" Width="Auto">
                </Fluent:ToggleButton>
            </DataTemplate>
        </Fluent:Ribbon.Resources>

        <!--Backstage-->
        <Fluent:Ribbon.Menu>
            <Fluent:Backstage>
                <Fluent:BackstageTabControl>
                    

                    <Fluent:Button Content="New" x:Name="NewQuery" Header="New" HorizontalContentAlignment="Left">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <cal:ActionMessage MethodName="NewQuery">
                                            
                                </cal:ActionMessage>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>

                    </Fluent:Button>
                    <!--
                    <Fluent:SplitButton Header="RunTo" IsButtonEnabled="True">
                        <StackPanel>
                            <Fluent:Button Header="Grid"></Fluent:Button>
                            <Fluent:Button Header="Timer"></Fluent:Button>
                        </StackPanel>
                    </Fluent:SplitButton>
                    -->
                    <Fluent:BackstageTabItem Header="Open">

                        <!-- Right-side content here -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Fluent:Button Header="Open" BorderBrush="DimGray" BorderThickness="1" Height="30">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="Click">
                                        <cal:ActionMessage MethodName="Open">
                                        </cal:ActionMessage>
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </Fluent:Button>
                        <StackPanel HorizontalAlignment="Left" Margin="20,0" Grid.Column="1">
                            <Label FontSize="14" Foreground="DimGray" FontWeight="Bold">Select a Document</Label>
                        </StackPanel>
                        </Grid>
                    </Fluent:BackstageTabItem>
                    <!--<Fluent:Button x:Name="NewQuery" Header="New Query"></Fluent:Button>-->
                    
                    <Fluent:Button Header="Save">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <cal:ActionMessage MethodName="Save">

                                </cal:ActionMessage>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>

                    </Fluent:Button>
                    <Fluent:Button Name="btnSaveAs" Header="Save As">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <cal:ActionMessage MethodName="SaveAs">

                                </cal:ActionMessage>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>

                    </Fluent:Button>
                    
                    <Fluent:Button Name="btnExit" Header="Exit">
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="Click">
                                <cal:ActionMessage MethodName="Exit">

                                </cal:ActionMessage>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </Fluent:Button>
                </Fluent:BackstageTabControl>
            </Fluent:Backstage>
        </Fluent:Ribbon.Menu>
        <!-- Home Tabs-->
        <Fluent:RibbonTabItem Header="Home">
            <Fluent:RibbonGroupBox Header="Query">
                <Fluent:Button Name="RunQuery" 
                               Header="Run"
                               Icon="{StaticResource PlayIcon}"
                               LargeIcon="{StaticResource PlayIcon}"
                    cal:Message.Attach="[Event Click] = [Action RunQuery()]">
                    <Fluent:Button.ToolTip>
                        <Fluent:ScreenTip Title="Run Query (F5)"
                                          Text="Executes the query and sends the results to the selected output"
                                           ></Fluent:ScreenTip>
                    </Fluent:Button.ToolTip>
                    
                </Fluent:Button>
                <!-- Output Targets -->
                <Fluent:DropDownButton Name="Output"
                                           Header="Output"
                                           LargeIcon="{Binding Path=SelectedTarget.Name,Converter={StaticResource OutputIcons}}"
                                           IsEnabled="True"
                                           VerticalAlignment="Top">
                    
                    <Fluent:Gallery 
                        SelectedFilter="{Binding ElementName=galleryFilterAll3}"
                        GroupBy="Group"
                        x:Name="OutputGallery"
                        MinItemsInRow="1"
                        MaxItemsInRow="4"
                        Orientation="Horizontal"
                        ItemWidth="100"
                        ItemHeight="100"
                        ItemsSource="{Binding ResultsTargets}"
                        SelectedItem="{Binding SelectedTarget}"
                        ItemTemplate="{DynamicResource ResultsTargetTemplate}">

                        <Fluent:Gallery.Filters>
                            <Fluent:GalleryGroupFilter Title="All"
                                                           Groups="Standard,Excel,Undefined"
                                                           x:Name="galleryFilterAll3" />
                            <Fluent:GalleryGroupFilter Title="Standard"
                                                           Groups="Standard" />
                            <Fluent:GalleryGroupFilter Title="Excel"
                                                           Groups="Excel" />
                        </Fluent:Gallery.Filters>

                       
                        </Fluent:Gallery>
                </Fluent:DropDownButton>
            </Fluent:RibbonGroupBox>
            
            <Fluent:RibbonGroupBox Header="Edit">
                <Fluent:Button x:Name="cutButton"
                                   Fluent:KeyTip.Keys="X"
                                   Header="Cut"
                                   Icon="Images\Cut.png"
                                   SizeDefinition="Middle,Small"
                                   Command="Cut">
                    <Fluent:Button.ToolTip>
                        <Fluent:ScreenTip Title="Cut (Ctrl+X)"
                                              Text="Cut the contents to the Clipboard."
                                              DisableReason="Cut is currently not available."
                                              Width="190" />
                    </Fluent:Button.ToolTip>
                </Fluent:Button>
                <Fluent:Button x:Name="copyButton"
                                   Fluent:KeyTip.Keys="C"
                                   Header="Copy"
                                   Icon="Images\Copy.png"
                                   SizeDefinition="Middle,Small"
                                   Command="Copy" />
                <Fluent:Button x:Name="pasteButton"
                                   Fluent:KeyTip.Keys="X"
                                   Header="Paste"
                                   Icon="..\Images\metro\clipboard.paste.png"
                                   SizeDefinition="Middle,Small"
                                   Command="Paste">
                    <Fluent:Button.ToolTip>
                        <Fluent:ScreenTip Title="Paste (Ctrl+V)"
                                              Text="Paste the contents to the Clipboard."
                                              DisableReason="Paste is currently not available."
                                              Width="190" />
                    </Fluent:Button.ToolTip>
                </Fluent:Button>
            </Fluent:RibbonGroupBox>
            
                        
            <Fluent:RibbonGroupBox Header="Connect">
                <Fluent:Button x:Name="Connect" Header="Connect"
Icon="Images\Green.png"
LargeIcon="Images\GreenLarge.png" />
                <TextBlock Text="Database:"/>

                <Fluent:ComboBox x:Name="Databases" 
                                 SelectedItem="{Binding SelectedDatabase}"
                                 ItemsSource="{Binding Databases}"   MinWidth="160" MaxWidth="220" 
                                 IsEditable="False"
                                 IsSynchronizedWithCurrentItem="True"></Fluent:ComboBox>
            </Fluent:RibbonGroupBox>
            <Fluent:RibbonGroupBox Header="Output" x:Name="OutputGroup" Visibility="{Binding OutputGroupIsVisible}" >
                <Fluent:ComboBox Name="cboOutputTo" Text="&lt;Output Sheet&gt;" MinWidth="120" MaxWidth="200" IsEditable="False"></Fluent:ComboBox>
            </Fluent:RibbonGroupBox>
            <Fluent:RibbonGroupBox Header="Traces" ItemsSource="{Binding TraceWatchers}"
                                   ItemTemplate="{DynamicResource TraceWatcherTemplate}">
                
            </Fluent:RibbonGroupBox>


        </Fluent:RibbonTabItem>
    </Fluent:Ribbon>
</UserControl>
